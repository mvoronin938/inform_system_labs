# Отчет по интеграции лабораторных работ и автоматизации сборки и публикации результатов

## Введение

В рамках работы была выполнена интеграция лабораторных работ **lab2**, **lab3**, **lab4** и **lab5** с автоматизацией процесса их сборки, тестирования и публикации результатов на GitHub Pages. Для этого был создан единый pipeline с использованием GitHub Actions, описанный в файле `deploy.yml`, расположенном в корневой директории проекта.

## Описание работы файла `deploy.yml`

Файл `deploy.yml` выполняет автоматизацию сборки и публикации результатов лабораторных работ. Он запускается при следующих событиях:

- При push в ветку `main`
- При ручном запуске через `workflow_dispatch`.

### Шаги выполнения pipeline

1. **Клонирование репозитория**

   ```yaml
   - name: checkout repo content
     uses: actions/checkout@v3
   ```

   Загружает содержимое репозитория для последующей обработки.

2. **Настройка Python**

   ```yaml
   - name: setup python
     uses: actions/setup-python@v4
     with:
       python-version: 3.12
   ```

   Устанавливает Python 3.12 для выполнения скриптов лабораторных работ **lab2**, **lab3** и **lab5**.

3. **Настройка JDK 23**

   ```yaml
   - name: Set up JDK 23
     uses: actions/setup-java@v3
     with:
       java-version: "23"
       distribution: "temurin"
       architecture: x64
   ```

   Устанавливает JDK 23 для компиляции и анализа кода лабораторной работы **lab4**.

4. **Запуск скрипта `generate-html.sh`**

   ```yaml
   - name: Run Python script and replace output in HTML
     run: |
       chmod +x .github/generate-html.sh
       .github/generate-html.sh
     env:
       # Переменные окружения для скриптов
   ```

   Этот шаг выполняет Bash-скрипт `generate-html.sh`, который:

   - Запускает Python-скрипты для **lab2**, **lab3** и **lab5** с использованием переданных переменных окружения.
   - Форматирует вывод скриптов и заменяет плейсхолдеры в HTML-шаблоне `report-template.html`.
   - Генерирует итоговый HTML-отчет с результатами этих лабораторных работ.

5. **Запуск анализа SpotBugs для `lab4`**

   ```yaml
   - name: Run SpotBugs Analysis
     working-directory: lab4/lab
     env:
       JAVA_HOME: ${{ env.JAVA_HOME }}
     run: |
       ant spotbugs
       mv ./build/spotbugs-report.html ../../.github/out/
   ```

   Выполняется:

   - Переход в директорию `lab4/lab`.
   - Запуск задачи `spotbugs` с помощью Ant, которая:
     - Компилирует код лабораторной работы **lab4**.
     - Выполняет статический анализ кода с помощью SpotBugs версии 4.8.6 (предварительно установленной и добавленной в репозиторий).
     - Генерирует HTML-отчет `spotbugs-report.html`.
   - Перемещение отчета в директорию `.github/out/` для публикации.

6. **Настройка и развертывание на GitHub Pages**

   ```yaml
   - name: Setup GitHub Pages
     uses: actions/configure-pages@v3

   - name: Upload artifact
     uses: actions/upload-pages-artifact@v2
     with:
       path: ".github/out/"

   - name: Deploy to pages
     id: deployment
     uses: actions/deploy-pages@v2
   ```

   Эти шаги выполняют конфигурацию GitHub Pages и публикуют сгенерированные отчеты на веб-сайте проекта.

## Детали выполненной работы

### Лабораторные работы 2, 3 и 5

- **Запуск скриптов**

  В скрипте `generate-html.sh` запускаются Python-скрипты для **lab2**, **lab3** и **lab5**. Выводы скриптов используются для формирования отчетов.

- **Форматирование вывода**

  Результаты выполнения скриптов форматируются: табуляции заменяются на неразрывные пробелы (`&nbsp;&nbsp;&nbsp;&nbsp;`), символы новой строки — на `<br>`, обеспечивая корректное отображение в HTML.

- **Генерация HTML-отчета**

  Отформатированные данные подставляются в шаблон `report-template.html`, создавая итоговый отчет.

### Лабораторная работа 4

- **Интеграция SpotBugs**

  Для **lab4** настроена сборка с использованием Ant и интегрирован статический анализатор SpotBugs 4.8.6.

- **Предварительная установка SpotBugs**

  SpotBugs установлен заранее и добавлен в репозиторий в `lab4/lab/spotbugs`, что устраняет необходимость его скачивания в pipeline.

- **Настройка Ant**

  В `lab4/lab/build.xml` настроены задачи:

  - `clean` — очистка предыдущих сборок.
  - `compile` — компиляция кода с использованием JDK 23.
  - `spotbugs` — запуск анализа кода.

- **Запуск анализа**

  В pipeline выполняется команда `ant spotbugs`, а отчет перемещается для публикации.

## Результаты

- **Автоматизация процесса**

  Единый pipeline `deploy.yml` автоматически выполняет сборку, тестирование и публикацию результатов всех лабораторных работ при обновлении репозитория.

- **Публикация на GitHub Pages**

  Отчеты лабораторных работ и отчет SpotBugs публикуются на GitHub Pages, обеспечивая доступность результатов.

- **Оптимизация процесса**

  Предварительная установка SpotBugs ускоряет выполнение pipeline и обеспечивает стабильность версии инструмента.

## Заключение

Была успешно выполнена интеграция лабораторных работ **lab2**, **lab3**, **lab4** и **lab5** в единый проект с автоматизированной сборкой и публикацией результатов. Использование GitHub Actions и статического анализа кода способствует повышению качества программного обеспечения и эффективной организации рабочего процесса.
